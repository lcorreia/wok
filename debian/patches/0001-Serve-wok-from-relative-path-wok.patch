From 173f5a4e4932651f6e12fa9ca7eafcbd7d3e213e Mon Sep 17 00:00:00 2001
From: Lucio Correia <luciojhc@linux.vnet.ibm.com>
Date: Fri, 11 Nov 2016 15:27:47 -0200
Subject: [PATCH] Serve wok from relative path /wok

Signed-off-by: Lucio Correia <luciojhc@linux.vnet.ibm.com>
---
 src/nginx/wok.conf | 6 +++---
 src/wok.conf.in    | 2 +-
 2 files changed, 4 insertions(+), 4 deletions(-)

diff --git a/src/nginx/wok.conf b/src/nginx/wok.conf
index 7fadf38..71d0906 100644
--- a/src/nginx/wok.conf
+++ b/src/nginx/wok.conf
@@ -49,7 +49,7 @@ server {
 
     # Update location path for relative path
     # e.g.: localtion /wok
-    location / {
+    location /wok {
         # Default cherrypy port for Wok is 8010
         # DO NOT forget to update cherrypy_port parameter in /etc/wok/wok.conf
         # when changing this value
@@ -59,12 +59,12 @@ server {
         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
         # Update location path for https for relative path
         # e.g.: proxy_redirect http://127.0.0.1:8010/ https://$host:8001/wok/;
-        proxy_redirect http://127.0.0.1:8010/ https://$host:8001/;
+        proxy_redirect http://127.0.0.1:8010/ https://$host:8001/wok/;
     }
 
     # Update location path for relative path
     # e.g.: localtion /wok/websockify
-    location /websockify {
+    location /wok/websockify {
         proxy_pass http://websocket;
         proxy_http_version 1.1;
         proxy_set_header Upgrade $http_upgrade;
diff --git a/src/wok.conf.in b/src/wok.conf.in
index 3806609..04a60b1 100644
--- a/src/wok.conf.in
+++ b/src/wok.conf.in
@@ -25,7 +25,7 @@
 # Wok server root. Set the following variable to configure any relative path to
 # the server. For example, to have Wok pointing to https://localhost:8001/wok/
 # uncomment the following:
-#server_root=/wok
+server_root=/wok
 
 [logging]
 # Log directory
-- 
2.7.4

